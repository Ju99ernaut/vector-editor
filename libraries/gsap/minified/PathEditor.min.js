/*
 VERSION: 0.2.1
 DATE: 2019-03-07
 UPDATES AND DOCS AT: http://greensock.com

 @license Copyright (c) 2008-2019, GreenSock. All rights reserved.
 This work is only for use by Club GreenSock members ("Shockingly Green" or higher) and is
 subject to the software agreement that was issued with the membership. See https://greensock.com/club/

 @author: Jack Doyle, jack@greensock.com
*/
var _gsScope="undefined"!==typeof module&&module.exports&&"undefined"!==typeof global?global:this||window;
(function(C){var G=_gsScope.GreenSockGlobals||_gsScope,ma=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,na=/(?:(-)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,oa=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/ig,w=document,ba=Math.PI/180,ca=Date.now||function(){return(new Date).getTime()},da=0,U=0,P,D,I,Q,R,L={},J=[],M={},x=[],ea=String.fromCharCode(103,114,101,101,110,115,111,99,107,46,99,111,109),pa=String.fromCharCode(47,114,101,113,117,105,114,101,115,45,109,101,109,98,101,114,115,104,105,112,47),V=function(a){for(var c=
-1!==(C?C.location.href:"").indexOf(String.fromCharCode(103,114,101,101,110,115,111,99,107))&&-1!==a.indexOf(String.fromCharCode(108,111,99,97,108,104,111,115,116)),b=[ea,String.fromCharCode(99,111,100,101,112,101,110,46,105,111),String.fromCharCode(99,111,100,101,112,101,110,46,112,108,117,109,98,105,110,103),String.fromCharCode(99,111,100,101,112,101,110,46,100,101,118),String.fromCharCode(99,115,115,45,116,114,105,99,107,115,46,99,111,109),String.fromCharCode(99,100,112,110,46,105,111),String.fromCharCode(103,
97,110,110,111,110,46,116,118),String.fromCharCode(99,111,100,101,99,97,110,121,111,110,46,110,101,116),String.fromCharCode(116,104,101,109,101,102,111,114,101,115,116,46,110,101,116),String.fromCharCode(99,101,114,101,98,114,97,120,46,99,111,46,117,107),String.fromCharCode(116,121,109,112,97,110,117,115,46,110,101,116),String.fromCharCode(116,119,101,101,110,109,97,120,46,99,111,109),String.fromCharCode(116,119,101,101,110,108,105,116,101,46,99,111,109),String.fromCharCode(112,108,110,107,114,46,
99,111),String.fromCharCode(104,111,116,106,97,114,46,99,111,109),String.fromCharCode(119,101,98,112,97,99,107,98,105,110,46,99,111,109),String.fromCharCode(97,114,99,104,105,118,101,46,111,114,103),String.fromCharCode(99,111,100,101,115,97,110,100,98,111,120,46,105,111),String.fromCharCode(115,116,97,99,107,98,108,105,116,122,46,99,111,109),String.fromCharCode(99,111,100,105,101,114,46,105,111),String.fromCharCode(106,115,102,105,100,100,108,101,46,110,101,116)],d=b.length;-1<--d;)if(-1!==a.indexOf(b[d]))return!0;
c&&C&&C.console&&console.log(String.fromCharCode(87,65,82,78,73,78,71,58,32,97,32,115,112,101,99,105,97,108,32,118,101,114,115,105,111,110,32,111,102,32)+"PathEditor"+String.fromCharCode(32,105,115,32,114,117,110,110,105,110,103,32,108,111,99,97,108,108,121,44,32,98,117,116,32,105,116,32,119,105,108,108,32,110,111,116,32,119,111,114,107,32,111,110,32,97,32,108,105,118,101,32,100,111,109,97,105,110,32,98,101,99,97,117,115,101,32,105,116,32,105,115,32,97,32,109,101,109,98,101,114,115,104,105,112,32,
98,101,110,101,102,105,116,32,111,102,32,67,108,117,98,32,71,114,101,101,110,83,111,99,107,46,32,80,108,101,97,115,101,32,115,105,103,110,32,117,112,32,97,116,32,104,116,116,112,58,47,47,103,114,101,101,110,115,111,99,107,46,99,111,109,47,99,108,117,98,47,32,97,110,100,32,116,104,101,110,32,100,111,119,110,108,111,97,100,32,116,104,101,32,39,114,101,97,108,39,32,118,101,114,115,105,111,110,32,102,114,111,109,32,121,111,117,114,32,71,114,101,101,110,83,111,99,107,32,97,99,99,111,117,110,116,32,119,
104,105,99,104,32,104,97,115,32,110,111,32,115,117,99,104,32,108,105,109,105,116,97,116,105,111,110,115,46,32,84,104,101,32,102,105,108,101,32,121,111,117,39,114,101,32,117,115,105,110,103,32,119,97,115,32,108,105,107,101,108,121,32,100,111,119,110,108,111,97,100,101,100,32,102,114,111,109,32,101,108,115,101,119,104,101,114,101,32,111,110,32,116,104,101,32,119,101,98,32,97,110,100,32,105,115,32,114,101,115,116,114,105,99,116,101,100,32,116,111,32,108,111,99,97,108,32,117,115,101,32,111,114,32,111,
110,32,115,105,116,101,115,32,108,105,107,101,32,99,111,100,101,112,101,110,46,105,111,46));return c}(C?C.location.host:""),F=function(a,c,b){a=w.createElementNS("http://www.w3.org/2000/svg",a);var d=/([a-z])([A-Z])/g,e;b=b||{};b["class"]=b["class"]||"path-editor";for(e in b)a.setAttributeNS(null,e.replace(d,"$1-$2").toLowerCase(),b[e]);c.appendChild(a);return a},fa=function(a){return w.createElementNS?w.createElementNS("http://www.w3.org/1999/xhtml",a):w.createElement(a)}("div"),W=!1,S=function(a){var c=
a.split(",");a=(void 0!==fa.onpointerdown?"pointerdown,pointermove,pointerup,pointercancel":void 0!==fa.onmspointerdown?"MSPointerDown,MSPointerMove,MSPointerUp,MSPointerCancel":a).split(",");for(var b={},d=4;-1<--d;)b[c[d]]=a[d],b[a[d]]=c[d];return b}("touchstart,touchmove,touchend,touchcancel"),y=function(a,c,b,d){if(a.addEventListener){var e=S[c];d=d||{passive:!1};a.addEventListener(e||c,b,d);e&&c!==e&&a.addEventListener(c,b,d)}else a.attachEvent&&a.attachEvent("on"+c,b)},z=function(a,c,b){a.removeEventListener?
(a.removeEventListener(S[c],b),c!==S[c]&&a.removeEventListener(c,b)):a.detachEvent&&a.detachEvent("on"+c,b)},ha=function(a){W=a.touches&&_dragCount<a.touches.length;z(a.target,"touchend",ha)},ia=function(a){W=a.touches&&_dragCount<a.touches.length;y(a.target,"touchend",ha)},qa=function(a,c,b,d,e,k,g,l,h){if(a!==l||c!==h){b=Math.abs(b);d=Math.abs(d);var r=Math.sqrt,t=2*Math.PI,u=e%360*ba;e=Math.cos(u);u=Math.sin(u);var m=(a-l)/2,n=(c-h)/2,q=e*m+u*n;m=-u*m+e*n;n=q*q;var A=m*m,f=n/(b*b)+A/(d*d);1<f&&
(b*=r(f),d*=r(f));f=b*b;var v=d*d;n=(f*v-f*A-v*n)/(f*A+v*n);0>n&&(n=0);n=(k===g?-1:1)*r(n);k=b*m/d*n;f=n*-(d*q/b);a=(a+l)/2+(e*k-u*f);c=(c+h)/2+(u*k+e*f);n=(q-k)/b;A=(m-f)/d;q=(-q-k)/b;m=(-m-f)/d;f=n*n+A*A;k=(0>A?-1:1)*Math.acos(n/r(f));q=(0>n*m-A*q?-1:1)*Math.acos((n*q+A*m)/r(f*(q*q+m*m)));!g&&0<q?q-=t:g&&0>q&&(q+=t);k%=t;q%=t;g=Math.ceil(Math.abs(q)/(t/4));t=[];r=q/g;n=4/3*Math.sin(r/2)/(1+Math.cos(r/2));A=e*b;b*=u;u*=-d;d*=e;for(f=0;f<g;f++)e=k+f*r,q=Math.cos(e),m=Math.sin(e),t.push(q-n*m,m+n*
q),q=Math.cos(e+=r),m=Math.sin(e),t.push(q+n*m,m-n*q,q,m);for(f=0;f<t.length;f+=2)q=t[f],m=t[f+1],t[f]=q*A+m*u+a,t[f+1]=q*b+m*d+c;t.splice(-2,2,l,h);return t}},X=function(a){var c=(a+"").replace(oa,function(a){a=+a;return 1E-4>a&&-1E-4<a?0:a}).match(ma)||[],b=[],d=0,e=0,k=c.length,g=2,l=0,h;if(!a||!isNaN(c[0])||isNaN(c[1]))return C.console&&console.log("ERROR: malformed path data: "+a),b;for(h=0;h<k;h++){var r=t;if(isNaN(c[h])){var t=c[h].toUpperCase();var u=t!==c[h]}else h--;var m=+c[h+1];var n=
+c[h+2];u&&(m+=d,n+=e);if(0===h){var q=m;var A=n}if("M"===t){f&&8>f.length&&(--b.length,g=0);d=q=m;e=A=n;var f=[m,n];l+=g;g=2;b.push(f);h+=2;t="L"}else if("C"===t)f||(f=[0,0]),f[g++]=m,f[g++]=n,u||(d=e=0),f[g++]=d+1*c[h+3],f[g++]=e+1*c[h+4],f[g++]=d+=1*c[h+5],f[g++]=e+=1*c[h+6],h+=6;else if("S"===t){if("C"===r||"S"===r){r=d-f[g-4];var v=e-f[g-3];f[g++]=d+r;f[g++]=e+v}else f[g++]=d,f[g++]=e;f[g++]=m;f[g++]=n;u||(d=e=0);f[g++]=d+=1*c[h+3];f[g++]=e+=1*c[h+4];h+=4}else if("Q"===t)r=m-d,v=n-e,f[g++]=d+
2*r/3,f[g++]=e+2*v/3,u||(d=e=0),d+=1*c[h+3],e+=1*c[h+4],r=m-d,v=n-e,f[g++]=d+2*r/3,f[g++]=e+2*v/3,f[g++]=d,f[g++]=e,h+=4;else if("T"===t)r=d-f[g-4],v=e-f[g-3],f[g++]=d+r,f[g++]=e+v,r=d+1.5*r-m,v=e+1.5*v-n,f[g++]=m+2*r/3,f[g++]=n+2*v/3,f[g++]=d=m,f[g++]=e=n,h+=2;else if("H"===t)n=e,f[g++]=d+(m-d)/3,f[g++]=e+(n-e)/3,f[g++]=d+2*(m-d)/3,f[g++]=e+2*(n-e)/3,f[g++]=d=m,f[g++]=n,h+=1;else if("V"===t)n=m,m=d,u&&(n+=e-d),f[g++]=m,f[g++]=e+(n-e)/3,f[g++]=m,f[g++]=e+2*(n-e)/3,f[g++]=m,f[g++]=e=n,h+=1;else if("L"===
t||"Z"===t){"Z"===t&&(m=q,n=A,f.closed=!0);if("L"===t||.5<Math.abs(d-m)||.5<Math.abs(e-n))f[g++]=d+(m-d)/3,f[g++]=e+(n-e)/3,f[g++]=d+2*(m-d)/3,f[g++]=e+2*(n-e)/3,f[g++]=m,f[g++]=n,"L"===t&&(h+=2);d=m;e=n}else if("A"===t){if(m=qa(d,e,1*c[h+1],1*c[h+2],1*c[h+3],1*c[h+4],1*c[h+5],(u?d:0)+1*c[h+6],(u?e:0)+1*c[h+7])){for(d=0;d<m.length;d++)f[g++]=m[d];d=f[g-2];e=f[g-1]}h+=7}else C.console&&console.log("Error: malformed path data: "+a)}b.totalPoints=l+g;return b},T=function(a,c,b,d,e,k,g,l,h,r,t){var u=
(a+b)/2,m=(c+d)/2,n=(b+e)/2,q=(d+k)/2,A=(e+g)/2,f=(k+l)/2,v=(u+n)/2,p=(m+q)/2;n=(n+A)/2;q=(q+f)/2;var w=(v+n)/2,x=(p+q)/2,y=g-a,z=l-c;b=Math.abs((b-g)*z-(d-l)*y);e=Math.abs((e-g)*z-(k-l)*y);r||(r=[a,c,g,l],t=2);r.splice(t||r.length-2,0,w,x);(b+e)*(b+e)>h*(y*y+z*z)&&(e=r.length,T(a,c,u,m,v,p,w,x,h,r,t),T(w,x,n,q,A,f,g,l,h,r,t+2+(r.length-e)));return r},ja=function(a,c,b,d){a=Y(a,c);c=a.length-2;var e=+a[0],k=+a[1],g=+a[2],l=+a[3],h=[e,k,e,k],r=g-e,t=l-k,u;isNaN(b)&&(b=Math.PI/10);d=d||0===d?.4*+d:
.4;for(u=2;u<c;u+=2){var m=e;var n=k;e=g;k=l;g=+a[u+2];l=+a[u+3];var q=r;var A=t;r=g-e;t=l-k;m=g-m;n=l-n;var f=q*q+A*A;var v=r*r+t*t;var p=m*m+n*n;var w=Math.acos((f+v-p)/Math.sqrt(4*f*v));p=w/Math.PI*d;f=Math.sqrt(f)*p;p*=Math.sqrt(v);w>b?(q=Math.atan2(n,m),h.push((1E3*(e-Math.cos(q)*f)|0)/1E3,(1E3*(k-Math.sin(q)*f)|0)/1E3,(1E3*e|0)/1E3,(1E3*k|0)/1E3,(1E3*(e+Math.cos(q)*p)|0)/1E3,(1E3*(k+Math.sin(q)*p)|0)/1E3)):(q=Math.atan2(A,q),h.push((1E3*(e-Math.cos(q)*f)|0)/1E3,(1E3*(k-Math.sin(q)*f)|0)/1E3),
q=Math.atan2(t,r),h.push((1E3*e|0)/1E3,(1E3*k|0)/1E3,(1E3*(e+Math.cos(q)*p)|0)/1E3,(1E3*(k+Math.sin(q)*p)|0)/1E3))}h.push((1E3*g|0)/1E3,(1E3*l|0)/1E3,(1E3*g|0)/1E3,(1E3*l|0)/1E3);return h},Z=function(a,c,b,d,e){var k=d,g=a[c],l=a[c+1],h=a[b],r=a[b+1],t;for(t=c+2;t<b;t+=2){var u=a[t],m=a[t+1],n=g,q=l,p=h-n,f=r-q;if(p||f){var v=((u-n)*p+(m-q)*f)/(p*p+f*f);1<v?(n=h,q=r):0<v&&(n+=p*v,q+=f*v)}p=u-n;f=m-q;v=p*p+f*f;if(v>k){var w=t;k=v}}k>d&&(2<w-c&&Z(a,c,w,d,e),e.push(a[w],a[w+1]),2<b-w&&Z(a,w,b,d,e))},
Y=function(a,c){var b=parseFloat(a[0]),d=parseFloat(a[1]),e=[b,d],k=a.length-2,g;c=c||1;c*=c;for(g=2;g<k;g+=2){var l=parseFloat(a[g]);var h=parseFloat(a[g+1]);var r=b-l;var t=d-h;r*r+t*t>c&&(e.push(l,h),b=l,d=h)}e.push(parseFloat(a[k]),parseFloat(a[k+1]));d=e.length-2;b=[e[0],e[1]];Z(e,0,d,c,b);b.push(e[d],e[d+1]);return b},N,ka=function(a,c,b,d,e,k,g,l,h,r,t,u,m,n){var q=(e-d)/k,p=0;for(N=9999999999;d<=e;){var f=1-d;var v=f*f*f*g+3*f*f*d*h+3*f*d*d*t+d*d*d*m;f=f*f*f*l+3*f*f*d*r+3*f*d*d*u+d*d*d*n;
v-=c;f-=b;v=v*v+f*f;v<N&&(N=v,p=d);d+=q}return 1<a?ka(a-1,c,b,Math.max(p-q,0),Math.min(p+q,1),k,g,l,h,r,t,u,m,n):p},H=function(a,c){return function(b){a.call(c,b)}};SVGElement.prototype.getTransformToElement=SVGElement.prototype.getTransformToElement||function(a){return a.getScreenCTM().inverse().multiply(this.getScreenCTM())};var ra=function(a){var c=this.target.parentNode.getScreenCTM();this._matrix=this.target.transform.baseVal.getItem(0).matrix;this._ctm=c.inverse();S[a.type]?(c=-1!==a.type.indexOf("touch")?
a.currentTarget||a.target:w,y(c,"touchend",this._onRelease),y(c,"touchmove",this._onMove),y(c,"touchcancel",this._onRelease),y(w,"touchstart",ia)):(c=null,y(w,"mousemove",this._onMove));y(w,"mouseup",this._onRelease);a.preventDefault();a.preventManipulation&&a.preventManipulation();a.changedTouches?(a=this.touch=a.changedTouches[0],this.touchID=a.identifier):a.pointerId?this.touchID=a.pointerId:this.touch=this.touchID=null;this._startPointerY=this.pointerY=a.pageY;this._startPointerX=this.pointerX=
a.pageX;this._startElementX=this._matrix.e;this._startElementY=this._matrix.f;1===this._ctm.a&&0===this._ctm.b&&0===this._ctm.c&&1===this._ctm.d?this._ctm=null:(a=this._startPointerX*this._ctm.a+this._startPointerY*this._ctm.c+this._ctm.e,this._startPointerY=this._startPointerX*this._ctm.b+this._startPointerY*this._ctm.d+this._ctm.f,this._startPointerX=a);this.isPressed=U=!0;this.touchEventTarget=c;this.vars.onPress&&this.vars.onPress.call(this.vars.callbackScope||this,this.pointerEvent)},sa=function(a){var c=
a,b,d;if(this._enabled&&!W&&this.isPressed&&a){this.pointerEvent=a;if(b=a.changedTouches){if(a=b[0],a!==this.touch&&a.identifier!==this.touchID){for(d=b.length;-1<--d&&(a=b[d]).identifier!==this.touchID;);if(0>d)return}}else if(a.pointerId&&this.touchID&&a.pointerId!==this.touchID)return;c.preventDefault();c.preventManipulation&&c.preventManipulation();this.setPointerPosition(a.pageX,a.pageY);this.vars.onDrag&&this.vars.onDrag.call(this.vars.callbackScope||this,this.pointerEvent)}},ta=function(a,
c){var b;if(!(b=!this._enabled||!this.isPressed)&&(b=a&&null!=this.touchID&&!c)&&!(b=a.pointerId&&a.pointerId!==this.touchID)&&(b=a.changedTouches)){a:{b=a.changedTouches;for(var d=b.length;-1<--d;)if(b[d].identifier===this.touchID){b=!0;break a}b=!1}b=!b}if(!b){da=ca();this.isPressed=U=!1;b=a;d=this.isDragging;var e=this.touchEventTarget,k;e?(z(e,"touchend",this._onRelease),z(e,"touchmove",this._onMove),z(e,"touchcancel",this._onRelease),z(w,"touchstart",ia)):z(w,"mousemove",this._onMove);z(w,"mouseup",
this._onRelease);a&&a.target&&z(a.target,"mouseup",this._onRelease);d?this.isDragging=!1:this.vars.onClick&&this.vars.onClick.call(this.vars.callbackScope||this,b);if(a){if(e=a.changedTouches)if(a=e[0],a!==this.touch&&a.identifier!==this.touchID){for(k=e.length;-1<--k&&(a=e[k]).identifier!==this.touchID;);if(0>k)return}this.pointerEvent=b;this.pointerX=a.pageX;this.pointerY=a.pageY}b&&!d&&this.vars.onDragRelease?this.vars.onDragRelease.call(this,this.pointerEvent):(b&&(b.preventDefault(),b.preventManipulation&&
b.preventManipulation()),this.vars.onRelease&&this.vars.onRelease.call(this.vars.callbackScope||this,this.pointerEvent));d&&this.vars.onDragEnd&&this.vars.onDragEnd.call(this.vars.callbackScope||this,this.pointerEvent);return!0}},O=function(a,c){this.target="string"===typeof a?w.querySelectorAll(a)[0]:a;this.vars=c||{};this._onPress=H(ra,this);this._onMove=H(sa,this);this._onRelease=H(ta,this);this.target.setAttribute("transform",(this.target.getAttribute("transform")||"")+" translate(0,0)");this._matrix=
this.target.transform.baseVal.getItem(0).matrix;this.x=this._matrix.e;this.y=this._matrix.f;this.snap=c.snap;isNaN(c.maxX)&&isNaN(c.minX)?this._bounds=0:(this._bounds=1,this.maxX=+c.maxX,this.minX=+c.minX);this.enabled(!0)},p=O.prototype;p.setPointerPosition=function(a,c){this.pointerX=a;this.pointerY=c;if(this._ctm){var b=a*this._ctm.a+c*this._ctm.c+this._ctm.e;c=a*this._ctm.b+c*this._ctm.d+this._ctm.f;a=b}b=c-this._startPointerY;var d=a-this._startPointerX;1>b&&-1<b&&(b=0);1>d&&-1<d&&(d=0);d=(1E3*
(this._startElementX+d)|0)/1E3;b=(1E3*(this._startElementY+b)|0)/1E3;this.snap&&!I&&(M.x=d,M.y=b,this.snap.call(this,M),d=M.x,b=M.y);if(this.x!==d||this.y!==b)this._matrix.f=this.y=b,this._matrix.e=this.x=d,!this.isDragging&&this.isPressed&&(this.isDragging=!0,this.vars.onDragStart&&this.vars.onDragStart.call(this.vars.callbackScope||this,this.pointerEvent))};p.enabled=function(a){if(!arguments.length)return this._enabled;if(this._enabled=a)y(this.target,"mousedown",this._onPress),y(this.target,"touchstart",
this._onPress),y(this.target,"click",this._onClick,!0);else{var c=this.isDragging;z(this.target,"mousedown",this._onPress);z(this.target,"touchstart",this._onPress);z(this.target,"click",this._onClick);this.touchEventTarget&&(z(this.touchEventTarget,"touchcancel",this._onRelease),z(this.touchEventTarget,"touchend",this._onRelease),z(this.touchEventTarget,"touchmove",this._onMove));z(w,"mouseup",this._onRelease);z(w,"mousemove",this._onMove);this.isDragging=this.isPressed=!1;c&&this.vars.onDragEnd&&
this.vars.onDragEnd.call(this.vars.callbackScope||this,this.pointerEvent)}return this};p.endDrag=function(a){this._onRelease(a)};var aa=function(a,c,b,d,e){this.editor=a;this.element=F("path",a._selection,{fill:"#4e7fff",stroke:"#4e7fff",strokeWidth:2,vectorEffect:"non-scaling-stroke"});this.update(c,b,d);this.element._gsSelection=!0;this.vars=e||{};this._draggable=new O(this.element,{callbackScope:this,onDrag:this.onDrag,snap:this.vars.snap,onPress:this.onPress,onRelease:this.onRelease,onClick:this.onClick,
onDragEnd:this.onDragEnd})},la=function(a,c,b,d){var e=a[c].length,k=[],g;for(g=0;g<e;g+=6)k.push(new aa(b,a,c,g,d));return k},K=function(a,c,b){var d=a[b]-a[c];a=a[b+1]-a[c+1];return Math.sqrt(d*d+a*a)};p=aa.prototype;p.onPress=function(){this.vars.onPress.call(this.vars.callbackScope||this,this)};p.onClick=function(){this.vars.onClick.call(this.vars.callbackScope||this,this)};p.onDrag=function(){var a=this.segment;this.vars.onDrag.call(this.vars.callbackScope||this,this,this._draggable.x-a[this.i],
this._draggable.y-a[this.i+1])};p.onDragEnd=function(){this.vars.onDragEnd.call(this.vars.callbackScope||this,this)};p.onRelease=function(){this.vars.onRelease.call(this.vars.callbackScope||this,this)};p.update=function(a,c,b){a&&(this.rawPath=a);1>=arguments.length?(c=this.j,b=this.i):(this.j=c,this.i=b);var d=this.smooth,e=this.rawPath[c];this.segment=e;this.smooth=b&&b<e.length-2&&.09>Math.abs(Math.atan2(e[b+1]-e[b-1],e[b]-e[b-2])-Math.atan2(e[b+3]-e[b+1],e[b+2]-e[b]))?2:0;this.smooth!==d&&this.element.setAttribute("d",
this.smooth?this.editor._circleHandle:this.editor._squareHandle);this.element.setAttribute("transform","translate("+e[b]+","+e[b+1]+")")};var E=G.PathEditor=function(a,c){c=c||{};if(!V)return C.location.href="http://"+ea+pa+"?plugin=PathEditor&source=codepen",!1;this.vars=c;this.path="string"===typeof a?w.querySelectorAll(a)[0]:a;this._selectionHittest=F("path",this.path.ownerSVGElement,{stroke:"transparent",strokeWidth:14,fill:"none",vectorEffect:"non-scaling-stroke"});this._selection=c._selection||
F("g",this.path.ownerSVGElement,{"class":"path-editor-selection path-editor"});this._selectionPath=F("path",this._selection,{stroke:"#4e7fff",strokeWidth:2,fill:"none",vectorEffect:"non-scaling-stroke"});this._selectedAnchors=[];this._line1=F("polyline",this._selection,{stroke:"#4e7fff",strokeWidth:2,vectorEffect:"non-scaling-stroke"});this._line2=F("polyline",this._selection,{stroke:"#4e7fff",strokeWidth:2,vectorEffect:"non-scaling-stroke"});this._line1.style.pointerEvents=this._line2.style.pointerEvents=
this._selectionPath.style.pointerEvents="none";this._enabled=!0;var b=this.path.parentNode.getScreenCTM().inverse();b=(b.a+b.d)/2*(c.handleSize||4);var d=(1E3*b|0)/1E3;this._squareHandle=["M-"+d,-d,d,-d,d,d,-d,d+"z"].join();b*=1.15;d=(552.284749831*b|0)/1E3;b=(1E3*b|0)/1E3;this._circleHandle="M"+b+",0C"+[b,d,d,b,0,b,-d,b,-b,d,-b,0,-b,-d,-d,-b,0,-b,d,-b,b,-d,b,0].join()+"z";this._handle1=F("path",this._selection,{d:this._squareHandle,fill:"#4e7fff",stroke:"transparent",strokeWidth:2});this._handle2=
F("path",this._selection,{d:this._squareHandle,fill:"#4e7fff",stroke:"transparent",strokeWidth:2});this._handle1._draggable=new O(this._handle1,{onDrag:this._onDragHandle1,callbackScope:this,onPress:this._onPressHandle1,onRelease:this._onReleaseHandle,onClick:this._onClickHandle1,snap:c.handleSnap});this._handle2._draggable=new O(this._handle2,{onDrag:this._onDragHandle2,callbackScope:this,onPress:this._onPressHandle2,onRelease:this._onReleaseHandle,onClick:this._onClickHandle2,snap:c.handleSnap});
this._handle1.style.visibility=this._handle2.style.visibility="hidden";b=[this._handle1,this._handle2,this._line1,this._line2,this._selection,this._selectionPath,this._selectionHittest];for(d=b.length;-1<--d;)b[d]._gsSelection=!0;!1!==c.draggable&&(this._draggable=new O(this._selectionHittest,{callbackScope:this,onPress:this.select,onRelease:this._onRelease,onDrag:this._onDragPath,onDragEnd:this._saveState,maxX:this.vars.maxX,minX:this.vars.minX}));if(!V)return!1;this.init();this._selection.style.visibility=
!1===c.selected?"hidden":"visible";!1!==c.selected&&(this.path._gsSelection=!0,B.push(this));this._saveState();y(this._selectionHittest,"mousedown",H(this._onClickSelectionPath,this));y(this._selectionHittest,"touchstart",H(this._onClickSelectionPath,this));y(this._selectionHittest,"mouseup",H(this._onRelease,this));y(this._selectionHittest,"touchend",H(this._onRelease,this))},B=[];p=E.prototype;p._onRelease=function(a){var c=this._editingAnchor;c&&(L.x=c.segment[c.i],L.y=c.segment[c.i+1]);this.vars.onRelease&&
this.vars.onRelease.call(this,a)};p.init=function(){var a=this.path.getAttribute("d"),c=X(a),b=!this._rawPath||c.totalPoints!==this._rawPath.totalPoints||c.length!==this._rawPath.length,d={callbackScope:this,snap:this.vars.anchorSnap,onDrag:this._onDragAnchor,onPress:this._onPressAnchor,onRelease:this._onRelease,onClick:this._onClickAnchor,onDragEnd:this._onDragEndAnchor,maxX:this.vars.maxX,minX:this.vars.minX},e;if(b&&this._anchors&&this._anchors.length){for(e=0;e<this._anchors.length;e++)this._anchors[e].element.parentNode.removeChild(this._anchors[e].element),
this._anchors[e]._draggable.enabled(!1);this._selectedAnchors.length=0}this._rawPath=c;if(b){if(this._anchors=la(c,0,this,d),b=c.length,1<b)for(e=1;e<b;e++)this._anchors=this._anchors.concat(la(c,e,this,d))}else for(e=this._anchors.length;-1<--e;)this._anchors[e].update(c);this._selection.appendChild(this._handle1);this._selection.appendChild(this._handle2);this._selectionPath.setAttribute("d",a);this._selectionHittest.setAttribute("d",a);this._selection.setAttribute("transform",this.path.getAttribute("transform")||
"translate(0,0)");this._selectionHittest.setAttribute("transform",this._selection.getAttribute("transform"));this._updateAnchors();return this};p._saveState=function(){var a=[],c=this._selectedAnchors,b;for(b=0;b<c.length;b++)a[b]=c[b].i;J.unshift({path:this,d:this.path.getAttribute("d"),transform:this.path.getAttribute("transform")||"",selectedIndexes:a});30<J.length&&(J.length=30)};p._onClickSelectionPath=function(a){if("hidden"===this._selection.style.visibility)this.select();else if(D){var c=
{callbackScope:this,snap:this.vars.anchorSnap,onDrag:this._onDragAnchor,onPress:this._onPressAnchor,onRelease:this._onRelease,onClick:this._onClickAnchor,onDragEnd:this._onDragEndAnchor,maxX:this.vars.maxX,minX:this.vars.minX},b=this._selection.getScreenCTM().inverse();this._draggable&&this._draggable._onRelease(a);if(b){var d=a.clientX*b.a+a.clientY*b.c+b.e;var e=a.clientX*b.b+a.clientY*b.d+b.f}b=this._rawPath;var k=d,g=e,l=d=e=0,h=9999999999,r,t;for(t=0;t<b.length;t++){var u=b[t];for(r=0;r<u.length;r+=
6){var m=ka(1,k,g,0,1,20,u[r],u[r+1],u[r+2],u[r+3],u[r+4],u[r+5],u[r+6],u[r+7]);h>N&&(h=N,e=t,d=r,l=m)}}b=this._rawPath[e];k=d;g=b[k];h=b[k+1];r=b[k+2];t=b[k+3];m=b[k+4];u=b[k+5];var n=b[k+6];var q=b[k+7];var p=g+(r-g)*l;var f=r+(m-r)*l;p+=(f-p)*l;f+=(m+(n-m)*l-f)*l;var v=h+(t-h)*l;var w=t+(u-t)*l;v+=(w-v)*l;w+=(u+(q-u)*l-w)*l;b.splice(k+2,4,(1E3*(g+(r-g)*l)|0)/1E3,(1E3*(h+(t-h)*l)|0)/1E3,(1E3*p|0)/1E3,(1E3*v|0)/1E3,(1E3*(p+(f-p)*l)|0)/1E3,(1E3*(v+(w-v)*l)|0)/1E3,(1E3*f|0)/1E3,(1E3*w|0)/1E3,(1E3*
(m+(n-m)*l)|0)/1E3,(1E3*(u+(q-u)*l)|0)/1E3);d+=6;for(b=0;b<this._anchors.length;b++)this._anchors[b].i>=d&&(this._anchors[b].i+=6);c=new aa(this,this._rawPath,e,d,c);this._selection.appendChild(this._handle1);this._selection.appendChild(this._handle2);c._draggable._onPress(a);R=c;this._anchors.push(c);this._selectedAnchors.length=0;this._selectedAnchors.push(c);this._updateAnchors();this.update();this._saveState()}};p._onClickHandle1=function(){var a=this._editingAnchor,c=a.i,b=a.segment;D&&5>Math.abs(b[c]-
b[c-2])&&5>Math.abs(b[c+1]-b[c-1])&&this._onClickAnchor(a)};p._onClickHandle2=function(){var a=this._editingAnchor,c=a.i,b=a.segment;D&&5>Math.abs(b[c]-b[c+2])&&5>Math.abs(b[c+1]-b[c+3])&&this._onClickAnchor(a)};p._onDragEndAnchor=function(a){R=null;this._saveState()};p.isSelected=function(){return 0<this._selectedAnchors.length};p.select=function(a){this._selection.style.visibility="visible";this._editingAnchor=null;this.path._gsSelection=!0;if(!0===a)for(a=this._anchors.length;-1<--a;)this._selectedAnchors[a]=
this._anchors[a];-1===B.indexOf(this)&&B.push(this);this._updateAnchors();return this};p.deselect=function(){this._selection.style.visibility="hidden";this._selectedAnchors.length=0;this._editingAnchor=null;this.path._gsSelection=!1;B.splice(B.indexOf(this),1);this._updateAnchors();return this};p._onDragPath=function(a){a=this._selectionHittest.getAttribute("transform")||"translate(0,0)";this._selection.setAttribute("transform",a);this.path.setAttribute("transform",a)};p._onPressAnchor=function(a){-1===
this._selectedAnchors.indexOf(a)?(I||(this._selectedAnchors.length=0),this._selectedAnchors.push(a)):I&&(this._selectedAnchors.splice(this._selectedAnchors.indexOf(a),1),a._draggable.endDrag());L.x=a.segment[a.i];L.y=a.segment[a.i+1];this._updateAnchors()};p._deleteSelectedAnchors=function(){for(var a=this._selectedAnchors,c=a.length,b,d;-1<--c;)for(b=a[c],b.element.parentNode.removeChild(b.element),b._draggable.enabled(!1),(d=b.i)?d<b.segment.length-2?b.segment.splice(d-2,6):b.segment.splice(d-4,
6):b.segment.splice(d,6),a.splice(c,1),this._anchors.splice(this._anchors.indexOf(b),1),b=0;b<this._anchors.length;b++)this._anchors[b].i>=d&&(this._anchors[b].i-=6);this._updateAnchors();this.update();this._saveState()};p._onClickAnchor=function(a){var c=a.i,b=a.segment,d=!c||c>=b.length-2;if(D&&R!==a&&this._editingAnchor)if(a.smooth=!a.smooth,d&&(a.smooth=!1),a.element.setAttribute("d",a.smooth?this._circleHandle:this._squareHandle),a.smooth&&!d){a=Math.atan2(b[c+1]-b[c-1],b[c]-b[c-2]);d=Math.atan2(b[c+
3]-b[c+1],b[c+2]-b[c]);a=(a+d)/2;var e=K(b,c-2,c);var k=K(b,c,c+2);.2>e&&(e=K(b,c,c-6)/4,a=d||Math.atan2(b[c+7]-b[c-5],b[c+6]-b[c-6]));.2>k&&(k=K(b,c,c+6)/4,d=a||Math.atan2(b[c+7]-b[c-5],b[c+6]-b[c-6]));var g=Math.sin(a);var l=Math.cos(a);Math.abs(d-a)<Math.PI/2&&(g=-g,l=-l);b[c-2]=(1E3*(b[c]+l*e)|0)/1E3;b[c-1]=(1E3*(b[c+1]+g*e)|0)/1E3;b[c+2]=(1E3*(b[c]-l*k)|0)/1E3;b[c+3]=(1E3*(b[c+1]-g*k)|0)/1E3;this._updateAnchors();this.update();this._saveState()}else a.smooth||d||(c&&(b[c-2]=b[c],b[c-1]=b[c+1]),
c<b.length-2&&(b[c+2]=b[c],b[c+3]=b[c+1]),this._updateAnchors(),this.update(),this._saveState());else I||(this._selectedAnchors.length=0,this._selectedAnchors.push(a));R=null;this._updateAnchors()};p._updateAnchors=function(){var a=1===this._selectedAnchors.length?this._selectedAnchors[0]:null,c=a?a.segment:null,b;this._editingAnchor=a;for(b=0;b<this._anchors.length;b++)this._anchors[b].element.setAttribute("fill",-1!==this._selectedAnchors.indexOf(this._anchors[b])?"#4e7fff":"white");a&&(this._handle1.setAttribute("d",
a.smooth?this._circleHandle:this._squareHandle),this._handle2.setAttribute("d",a.smooth?this._circleHandle:this._squareHandle));b=a?a.i:0;if(a&&b){var d=c[b-2];var e=c[b-1];this._handle1.style.visibility=this._line1.style.visibility=D||d!==c[b]||e!==c[b+1]?"visible":"hidden";this._handle1.setAttribute("transform","translate("+d+","+e+")");this._line1.setAttribute("points",d+","+e+","+c[b]+","+c[b+1])}else this._handle1.style.visibility=this._line1.style.visibility="hidden";a&&b<c.length-2?(d=c[b+
2],e=c[b+3],this._handle2.style.visibility=this._line2.style.visibility=D||d!==c[b]||e!==c[b+1]?"visible":"hidden",this._handle2.setAttribute("transform","translate("+d+","+e+")"),this._line2.setAttribute("points",c[b]+","+c[b+1]+","+d+","+e)):this._handle2.style.visibility=this._line2.style.visibility="hidden"};p._onPressAlt=function(){var a=this._editingAnchor;a&&(a.i&&(this._handle1.style.visibility=this._line1.style.visibility="visible"),a.i<a.segment.length-2&&(this._handle2.style.visibility=
this._line2.style.visibility="visible"))};p._onReleaseAlt=function(){var a=this._editingAnchor;if(a){var c=a.segment;a=a.i;c[a]===c[a-2]&&c[a+1]===c[a-1]&&(this._handle1.style.visibility=this._line1.style.visibility="hidden");c[a]===c[a+2]&&c[a+1]===c[a+3]&&(this._handle2.style.visibility=this._line2.style.visibility="hidden")}};p._onPressHandle1=function(){this._editingAnchor.smooth&&(this._oppositeHandleLength=K(this._editingAnchor.segment,this._editingAnchor.i,this._editingAnchor.i+2))};p._onPressHandle2=
function(){this._editingAnchor.smooth&&(this._oppositeHandleLength=K(this._editingAnchor.segment,this._editingAnchor.i-2,this._editingAnchor.i))};p._onReleaseHandle=function(a){this._onRelease(a);this._saveState()};p._onDragHandle1=function(){var a=this._editingAnchor,c=a.segment,b=a.i,d=this._handle1._draggable.x,e=this._handle1._draggable.y;c[b-2]=d=(1E3*d|0)/1E3;c[b-1]=e=(1E3*e|0)/1E3;a.smooth&&(D?(a.smooth=!1,a.element.setAttribute("d",this._squareHandle),this._handle1.setAttribute("d",this._squareHandle),
this._handle2.setAttribute("d",this._squareHandle)):(a=Math.atan2(c[b+1]-e,c[b]-d),d=this._oppositeHandleLength*Math.cos(a),e=this._oppositeHandleLength*Math.sin(a),c[b+2]=(1E3*(c[b]+d)|0)/1E3,c[b+3]=(1E3*(c[b+1]+e)|0)/1E3));this.update()};p._onDragHandle2=function(){var a=this._editingAnchor,c=a.segment,b=a.i,d=this._handle2._draggable.x,e=this._handle2._draggable.y;c[b+2]=d=(1E3*d|0)/1E3;c[b+3]=e=(1E3*e|0)/1E3;a.smooth&&(D?(a.smooth=!1,a.element.setAttribute("d",this._squareHandle),this._handle1.setAttribute("d",
this._squareHandle),this._handle2.setAttribute("d",this._squareHandle)):(a=Math.atan2(c[b+1]-e,c[b]-d),d=this._oppositeHandleLength*Math.cos(a),e=this._oppositeHandleLength*Math.sin(a),c[b-2]=(1E3*(c[b]+d)|0)/1E3,c[b-1]=(1E3*(c[b+1]+e)|0)/1E3));this.update()};p._onDragAnchor=function(a,c,b){var d=this._selectedAnchors,e=d.length,k;for(k=0;k<e;k++){var g=d[k];var l=g.i;var h=g.segment;l&&(h[l-2]=(1E3*(h[l-2]+c)|0)/1E3,h[l-1]=(1E3*(h[l-1]+b)|0)/1E3);h[l]=(1E3*(h[l]+c)|0)/1E3;h[l+1]=(1E3*(h[l+1]+b)|
0)/1E3;l<h.length-2&&(h[l+2]=(1E3*(h[l+2]+c)|0)/1E3,h[l+3]=(1E3*(h[l+3]+b)|0)/1E3);g!==a&&g.element.setAttribute("transform","translate("+h[l]+","+h[l+1]+")")}this.update()};p.enabled=function(a){if(!arguments.length)return this._enabled;for(var c=this._anchors.length;-1<--c;)this._anchors[c]._draggable.enabled(a);this._enabled=a;this._handle1._draggable.enabled(a);this._handle2._draggable.enabled(a);this._draggable&&this._draggable.enabled(a);a?this._selection.parentNode||(this.path.ownerSVGElement.appendChild(this._selectionHittest),
this.path.ownerSVGElement.appendChild(this._selection),this.init(),this._saveState()):(this.deselect(),this.path.ownerSVGElement.removeChild(this._selectionHittest),this.path.ownerSVGElement.removeChild(this._selection));this._updateAnchors();return this.update()};p.update=function(a){var c="",b=this._editingAnchor;a&&this.init();if(b){var d=b.i;b=b.segment;if(d){var e=b[d-2];var k=b[d-1];this._handle1.setAttribute("transform","translate("+e+","+k+")");this._line1.setAttribute("points",e+","+k+","+
b[d]+","+b[d+1])}d<b.length-2&&(e=b[d+2],k=b[d+3],this._handle2.setAttribute("transform","translate("+e+","+k+")"),this._line2.setAttribute("points",b[d]+","+b[d+1]+","+e+","+k))}if(a)c=this.path.getAttribute("d");else{for(d=0;d<this._rawPath.length;d++)b=this._rawPath[d],7<b.length&&(c+="M"+b[0]+","+b[1]+"C"+b.slice(2).join(","));this.path.setAttribute("d",c);this._selectionPath.setAttribute("d",c);this._selectionHittest.setAttribute("d",c)}this.vars.onUpdate&&this._enabled&&this.vars.onUpdate.call(this,
c);return this};p.getNormalizedSVG=function(a,c,b,d){var e=this._rawPath[0],k=-1*e[0],g=0===c?0:-(c||e[1]);c=e.length;var l=1/(e[c-2]+k),h=-a||e[c-1]+g;x.length=0;h=h?1/h:-l;l*=1E3;h*=1E3;for(a=0;a<c;a+=2)x[a]=((e[a]+k)*l|0)/1E3,x[a+1]=((e[a+1]+g)*h|0)/1E3;if(d){e=[];c=x.length;for(a=2;a<c;a+=6)k=x[a-2],g=x[a-1],l=x[a+4],h=x[a+5],e.push(k,g,l,h),T(k,g,x[a],x[a+1],x[a+2],x[a+3],l,h,.001,e,e.length-2);k=e[0];c=e.length;for(a=2;a<c;a+=2){l=e[a];if(l<k||1<l||0>l){d();break}k=l}}if(b&&8===c&&0===x[0]&&
0===x[1]&&1===x[c-2]&&1===x[c-1])return x.slice(2,6).join(",");x[2]="C"+x[2];return"M"+x.join(",")};G=function(a){if(!a.target._gsSelection&&!U&&100<ca()-da){for(a=B.length;-1<--a;)B[a].deselect();B.length=0}};w.addEventListener("keydown",function(a){var c;if(16===a.which)I=!0;else if(17===a.which)P=!0;else if(91===a.which)Q=!0;else if(18===a.which)for(D=!0,a=B.length;-1<--a;)B[a]._onPressAlt();else if(90===a.which&&(P||Q)&&1<J.length){if(J.shift(),c=J[0]){var b=c.path;b.path.setAttribute("d",c.d);
b.path.setAttribute("transform",c.transform);b.init();var d=b._anchors;for(a=0;a<d.length;a++)-1!==c.selectedIndexes.indexOf(d[a].i)&&b._selectedAnchors.push(d[a]);b._updateAnchors();b.update();b.vars.onUndo&&b.vars.onUndo.call(b)}}else if(8===a.which||46===a.which)for(a=B.length;-1<--a;)B[a]._deleteSelectedAnchors();else if(65===a.which&&(Q||P))for(a=B.length;-1<--a;)B[a].select(!0)});w.addEventListener("keyup",function(a){if(16===a.which)I=!1;else if(17===a.which)P=!1;else if(91===a.which)Q=!1;
else if(18===a.which)for(D=!1,a=B.length;-1<--a;)B[a]._onReleaseAlt()});y(w,"mouseup",G);y(w,"touchend",G);E.version="0.2.1";E.simplifyPoints=Y;E.pointsToBezier=ja;E.simplifySVG=function(a,c){var b;c=c||{};var d=c.tolerance||1;var e=c.precision||1/d;var k=(void 0===c.cornerThreshold?18:+c.cornerThreshold)*ba;if("string"!==typeof a){var g=a;a=g.getAttribute("d")}if(!V)return!1;("#"===a.charAt(0)||"."===a.charAt(0))&&(g=w.querySelector(a))&&(a=g.getAttribute("d"));var l=!1!==c.curved||/[achqstvz]/ig.test(a)?
X(a)[0]:a.match(na);if(!1!==c.curved){var h=l;l=[];var r=h.length;for(b=2;b<r;b+=6){var t=+h[b-2];var p=+h[b-1];var m=+h[b+4];var n=+h[b+5];l.push((1E3*t|0)/1E3,(1E3*p|0)/1E3,(1E3*m|0)/1E3,(1E3*n|0)/1E3);T(t,p,+h[b],+h[b+1],+h[b+2],+h[b+3],m,n,1/(2E5*e),l,l.length-2)}l=ja(l,d,k,c.curviness);l[2]="C"+l[2]}else l=Y(l,d);a="M"+l.join(",");g&&g.setAttribute("d",a);return a};E.create=function(a,c){return new E(a,c)};E.getCubicSVGData=function(a){var c="";a=X(a);var b=a.length,d,e;for(d=0;d<b;d++){var k=
a[d];c+="M"+k[0]+","+k[1]+" C";var g=k.length;for(e=2;e<g;e++)c+=(1E3*k[e++]|0)/1E3+","+(1E3*k[e++]|0)/1E3+" "+(1E3*k[e++]|0)/1E3+","+(1E3*k[e++]|0)/1E3+" "+(1E3*k[e++]|0)/1E3+","+(1E3*k[e]|0)/1E3+" ";k.closed&&(c+="z")}return c};E.editingAxis=L;E.getSnapFunction=function(a){var c=a.radius||2,b=a.x||0===a.x?a.x:a.width?0:-999999999999,d=a.y||0===a.y?a.y:a.height?0:-999999999999,e=b+(a.width||999999999999*999999999999),k=d+(a.height||999999999999*999999999999),g=!1!==a.containX,l=!1!==a.containY,h=
a.axis,r=a.gridSize;c*=c;return function(a){var p=a.x,m=a.y,n,q;if(g&&p<b||(n=p-b)*n<c)p=b;else if(g&&p>e||(n=e-p)*n<c)p=e;if(l&&m<d||(q=m-d)*q<c)m=d;else if(l&&m>k||(q=k-m)*q<c)m=k;h&&(n=p-h.x,q=m-h.y,n*n<c&&(p=h.x),q*q<c&&(m=h.y));if(r){var t=b+Math.round((p-b)/r)*r;n=t-p;var f=d+Math.round((m-d)/r)*r;q=f-m;n*n+q*q<c&&(p=t,m=f)}a.x=p;a.y=m}}})(_gsScope);
(function(C){var G=function(){return(_gsScope.GreenSockGlobals||_gsScope)[C]};"undefined"!==typeof module&&module.exports?module.exports=G():"function"===typeof define&&define.amd&&define([],G)})("PathEditor");